<imart type="head">
<html lang="jp">
	<meta charset="utf-8">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<title><imart type="message" id="LO.TITLE.KIKAKU.PLANNING_FORM_ITEM" escapeXml="true" /></title>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" type="text/css" href="lo_csjs/reset.css">
	<link rel="stylesheet" type="text/css" href="lo_csjs/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="lo_csjs/all.min.css">
	<link rel="stylesheet" href="lo_csjs/tempusdominus-bootstrap-4.min.css" />
	<link rel="stylesheet" href="lo_csjs/cform.css">
	<link rel="stylesheet" href="lo_csjs/selectize.default.css">
	<link rel="stylesheet" type="text/css" href="lo_csjs/progress-tracker.css">
	<link rel="stylesheet" type="text/css" href="lo_csjs/checkbox.css">
	<link rel="stylesheet" type="text/css" href="lo_csjs/basetype.css">
	<link rel="stylesheet" type="text/css" href="lo_csjs/udcolor_sample.css">
	<link href="lo_csjs/jquery.fileuploader.min.css" media="all" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="lo_csjs/fileupload.css" />
	<link rel="stylesheet" type="text/css" href="lo_csjs/lo_common.css" />

	<script type="text/javascript" src="lo_csjs/jquery-ui.min.js" ></script>
	<script type="text/javascript" src="lo_csjs/popper.min.js" ></script>
	<script type="text/javascript" src="lo_csjs/moment.min.js"></script>
	<script type="text/javascript" src="lo_csjs/ja.js"></script>
	<script type="text/javascript" src="lo_csjs/bootstrap.min.js"></script>
	<!-- script type="text/javascript" src="lo_csjs/tempusdominus-bootstrap-4.min.js"></script  -->
	<script type="text/javascript" src="lo_csjs/jquery.maskMoney.min.js"></script>
	<script type="text/javascript" src="lo_csjs/index.js"></script>
	<script type="text/javascript" src="lo_csjs/bootstrap-multiselect.js"></script>
	<script type="text/javascript" src="lo_csjs/jquery.dataTables.min.js"></script>
	<script type="text/javascript" src="lo_csjs/dataset.js"></script>
	<script type="text/javascript" src="lo_csjs/selectize.min.js"></script>
	<script type="text/javascript" src="lo_csjs/jquery.fileuploader.min.js"></script>
	<script type="text/javascript" src="lo_csjs/custom.js"></script>
	<script type="text/javascript" src="lo_csjs/popup.js"></script>
	
	<script type="text/javascript" src="lo_csjs/lo_common.js"></script>
	<imart type="include" page="lo/contents/screen/footer"></imart>
	<script type="text/javascript" src="lo_csjs/form-change-trigger.js"></script>
	<script src="https://kit.fontawesome.com/b5f0d7b6c6.js" crossorigin="anonymous"></script>

	<!-- IMART -->
	<IMART type="jsspRpc" name="jsspRpcPlanShohin" page="lo/contents/screen/kikaku/planning_form_item_new" callback="editCallback" onErrorCallback="editError"></IMART>

<style>
	.left-justified {
		padding-left: 0px !important;
	}
	.right-justified {
		padding-right: 0px !important;
	}
	.padding-top {
		padding-top: 0.7rem !important;
	}
	.margin-left {
		margin-left: 0 !important;
	}
	.full_width {
		width: 100% !important;
	}
	.chiiki_width {
		width: 84% !important;
	}
	.form_width {
		width:105px !important;
	}
	.radio_height {
		height:40px !important;
	}
	.mar-left {
		margin-left: 16px;
	}
	.licensePro_color {
		background-color : #98fb98;
	}
	.local-nav {
    	position: -webkit-sticky;
    	position: sticky;
    	top: 80px;
    	z-index: 1030;
		margin: 0px;
		padding: 0px;
    	background-color: #FFFFFF;
	}
	.local-nav2 {
    	position: -webkit-sticky;
    	position: sticky;
    	top: 157px;
    	z-index: 1030;
    	margin: 0px;
		padding: 0px;
		background-color: #f3f3f3;
	}
	.form-area {
		background-color: #f3f3f3;
		margin: 2px 0px 60px;
		padding-top: 0 !important;
		padding-left: 40px !important;
		padding-right: 40px !important;
		border: 1px solid #84919e;
	}
	.mar-bot {
		margin-bottom: 10px;
	}
	.margin-top {
		margin-top: 40px !important;
	}
	.mark-req {
		color: red;
	}
	.line-height {
		line-height: 100px;
	}
	.line-height2 {
		line-height: 270px;
	}
	
	.hanbaiyoteikosu-area{
		min-width: 100px;
	}
</style>

<script>

	var $fileList = [];
	var $tempUpFileCount = 0;
	var $tempUpFileSuccessCount = 0;
	var $tempUpFileErrotCount = 0;

	$("#file_upload_btn").on("click", function() {
		var $form = $("#filesForm");
		var $file = $form.find(".imui-fileupload-input");
		$file.focus();
		$file.click(); //imartのファイルアップロード選択ボタンをクリックしてやる
	});

	// ---- 詳細資料ファイル -------
	// ファイルアップロード前処理用
	function onBeforeSendFiles(e, data) {
		// プロダクション制限
		<imart type="condition" validity=$production_flg>return false;</imart>
		
		// ファイル数制限
		var uploadedNum = $("#complete_images .afterFileSelect").size() - 1;
		var max_file_num = <imart type="string" value=$maxFileNum />;
		if(uploadedNum + $tempUpFileCount + data.files.length >= max_file_num) {
			return false;
		}
		
		var str = '<imart type="string" value=$extListstr />';
		var max_file_size = <imart type="string" value=$maxFileSize />;
		var acceptExt =str.split("/");
		for (var fIdx = 0; fIdx < data.files.length; fIdx++) {
			// ファイルサイズチェック
			if(data.files[fIdx].size > max_file_size) {
				alert('<imart type="message" id="ER01E005" escapeJs="true"></imart>');
				return false;
			}
			
			// 拡張子チェック
			var ext = getFileExtension(data.files[fIdx].name);
			if (!acceptExt.includes(ext)) {
				var altstr = '<imart type="message" id="KK03E039" escapeJs="true"></imart>';
				altstr = altstr.replace("{0}", data.files[fIdx].name);
				alert(altstr);
				return false;
			}
		}
		// TODO:アップロードするファイルのサイズや拡張子をチェック
		// TODO:複数ファイルのアップロードをしたときに、途中のファイルがfalseを返却した場合は、後続は続行されるか確認
		// TODO:インジケータ表示のために、アップロードされたファイルをカウントする仮実装
		showIndicator();
		$tempUpFileCount += data.files.length;
		return true;
	}
	// ファイルアップロード成功時
	function onSuccessFiles(e, data) {
		// TODO:インジケータ表示のために、アップロードされたファイルをカウントする仮実装
		$tempUpFileSuccessCount += data.result.length;
		$.each(data.result, function(index, res) {
			
			var src ="lo/contents/screen/ses_file_dl?filePath=" + res.physicalName + "&fileName=" + res.name;
			var a_src = $('<a>').attr({'href':src, 'download':''});
			var template = $(".completeImageTemplate");
			var clon = template.clone(true);
			clon.removeClass("completeImageTemplate");
			clon.find(".upfilenametext").text(res.name);
			clon.find(".upfilenametext").wrap(a_src);
			clon.find('input[name="item_upFile_name"]').val(res.name);
			clon.find('input[name="item_upFile_resname"]').val(res.physicalName);
			
			var img_src;
			if(getFileExtension(res.name) == "pdf") {
				img_src = $('<i>').attr('class', 'far fa-file-pdf fa-9x mb-2 text-danger');
				clon.find(".imgFile").html(img_src);
				clon.find(".imgFile>i").wrap(a_src);
			} else {
				img_src = $('<img>').attr('src', src);
				img_src.attr("class","img-responsive");
				clon.find(".imgFile").html(img_src);
				clon.find(".imgFile>img").wrap(a_src);
			}
			clon.find("a").css("display", "");

			clon.css("display", "");
			clon.appendTo("#complete_images");
			template.hide();
		});
		// 必須項目確認
		validateAndShowMessage();
		
		// TODO:インジケータ表示のために、アップロードされたファイルをカウントする仮実装
		if ($tempUpFileCount == $tempUpFileSuccessCount + $tempUpFileErrotCount) {
			$tempUpFileCount = 0;
			$tempUpFileSuccessCount = 0;
			$tempUpFileErrotCount = 0;
			//$("body").imuiIndicator("destroy");は再利用できないのでhide()で隠す
			hideIndicator();
		}
	}

	// アップロード失敗
	function onErrorFiles(e, data) {
		// TODO:失敗時の処理をいれる
		// TODO:インジケータ表示のために、アップロードされたファイルをカウントする仮実装
		$tempUpFileErrotCount += data.files.length;
		if ($tempUpFileCount == $tempUpFileSuccessCount + $tempUpFileErrotCount) {
			$tempUpFileCount = 0;
			$tempUpFileSuccessCount = 0;
			$tempUpFileErrotCount = 0;
			//$("body").imuiIndicator("destroy");は再利用できないのでhide()で隠す
			hideIndicator();
		}
	}
	// ---- 詳細資料ファイル -------

	// ---- ファイルアップロード共通 -------
	// アップロード削除
	function upFileDel(targetEl){
		// TODO:確認メッセージを表示
		var targetObj = $(targetEl).closest("div.completeImage");
		targetObj.remove();
		
		if ($(".completeImage:not(.completeImageTemplate)").length === 0) {
			$(".completeImageTemplate").css("display", "");
		}
		
		// 必須項目チェック
    	validateAndShowMessage();
	}
	// ---- ファイルアップロード共通 -------

 	// 地域表示変更
    function chiiki_chk() {
    	var param = $('#inputFrom').serializeObject();
    	
    	if (param.chiiki == "2") {
    		$('[name=hanbaiyoteikosu_nihon]').prop('disabled',false);
    		$('.sec_tiiki1').show();
    		$('#localize_shohin_umu').prop('disabled',false);
    	} else {
    		$('[name=hanbaiyoteikosu_nihon]').prop('disabled',true);
    		linkShokaiSeisanYoteisu();
    		$('.sec_tiiki1').hide(); 
    		$('#localize_shohin_umu').prop('disabled',true);
    	}
    	localizeShohinUmu_chk();
    }
	
	// ローカライズ商品名の有無
	function localizeShohinUmu_chk() {
		if ($('#chiiki').val() == '2' && $('#localize_shohin_umu').val() == '1') {
			$('#localize_shohin_nm').prop('disabled', false);
			$('.sec_localize_shohin').show(); 
		} else {
			$('#localize_shohin_nm').prop('disabled', true);
			$('.sec_localize_shohin').hide(); 
		}
		validateAndShowMessage();
	}
</script>
</imart>

<body id="body" style="display: none">
	<!-- header -->
	<div class="container-fluid">
		<IMART type="include" page="lo/contents/screen/header"></IMART>
	</div>
	
	<!-- 画面遷移用 -->
	<form id="sendFrom" method="post"
		action="lo/contents/screen/kikaku/planning_form_new">
		<IMART type="hidden" kikaku_id=$kikaku_data.kikaku_id></IMART>
		<imart type="hidden" kikaku_edaban=$kikaku_data.kikaku_edaban />
	</form>
		
	<div class="container">
		<div class="row">
			<!-- sidebar -->
			<div id="lo_sidebar">
				<div class="sidebar_fixed">
					<IMART type="include" page="lo/contents/screen/sidemenu"></IMART>
				</div>
			</div>
			<!-- sidebar -->
			<!-- main contents -->
			<div class="main col">
				<!-- sidebar show -->
				<a id="show-sidebar" class="btn" style="display: none">
					<i class="fas fa-share-square"></i>
				</a>
				<!-- sidebar show -->
				<!-- contents custom -->

	<article>
		<div class="container">
			<div class="page-information row local-nav my-4">
				<div class="col-12 col-lg-3">
					<h1><imart type="message" id="LO.TITLE.KIKAKU.PLANNING_FORM_ITEM" escapeXml="true" /> #<imart type="string" value=$kikaku_data.kikaku_edaban /></h1>
					<button type="button" id="btn_back" class="brdr_orange txt_orange mt-2" onclick="history.back();">
						<i class="fas fa-caret-left "></i><span>戻る</span>
					</button>
				</div>
			</div>
			<div class="row">
				<div class="col-12">
					<form role="form" id="inputFrom" autocomplete="off">
						<imart type="hidden" kikaku_id=$kikaku_data.kikaku_id />
						<imart type="hidden" kikaku_edaban=$kikaku_data.kikaku_edaban />
						<imart type="hidden" koushin_bi=$kikaku_data.koushin_bi />
						<div class="form-area margin-top">
							<section class="show local-nav2">
								<div class="col-12 mt-2 mb-2 row">
									<h2>基本情報</h2>
								</div>
								<div class="col-12 border-bottom mt-2 mb-2">
									<div class="form-group row mb-2">
										<div class="col-4 col-lg-2 mb-2 t-header txt_block bg_ltorange brdr_dkgray text-center padding-top licensePro-hide">カテゴリ<span class="mark-req"> *</span></div>
										<div class="col-6 col-lg-4 mb-2 left-justified licensePro-hide">
											<imart type="imuiSelect" class="form-control full_width require" name="shohin_category" id="shohin_category" list=$categoryList />
										</div>
										<div class="col-4 col-lg-2 mb-2 t-header txt_block bg_ltorange brdr_dkgray text-center padding-top licensee-hide">カテゴリ</div>
										<div class="col-6 col-lg-4 mb-2 left-justified licensee-hide">
											<imart type="input" style="text" class="form-control full_width" name="shohin_category2" id="shohin_category2" value=$category_nm readonly></IMART>
										</div>
										<div class="col-4 col-lg-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top">商品名<span class="mark-req"> *</span></div>
										<div class="col-6 col-lg-4 left-justified">
											<IMART type="input" style="text" maxlength="200" class="form-control mb-2 require" name="shohin_nm" id="shohin_nm" value=$item_data.shohin_nm escapeXml="true" ></IMART>
										</div>
									</div>
								</div>
							</section>
							<section class="show">
								<div class="col-12 border-bottom mt-2 mb-2">
									<div class="form-group row mb-2">
										<div class="col-3">
											<div class="row">
												<div class="col-6 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top radio_height">税抜上代<span class="mark-req"> *</span></div>
												<div class="col-6 left-justified">
													<div class="input-group">
														<IMART type="input" style="text" maxlength="15" step="0.00001" class="form-control mask_money radio_height num-only require text-decimal" name="zeinuki_jodai" id="zeinuki_jodai" value=$item_data.zeinuki_jodai oninput="" ></IMART>
														<div class="input-group-append">
															<span class="input-group-text" id="fca6">円</span>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="col-3">
											<div class="row">
												<div class="col-6 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top radio_height">目標販売数<span class="mark-req"> *</span></div>
												<div class="col-6 left-justified">
													<div class="input-group">
														<IMART type="input" style="text" maxlength="9" class="form-control radio_height nat-only text-number require" name="mokuhyo_hambai_su" id="mokuhyo_hambai_su" value=$item_data.mokuhyo_hambai_su oninput="" ></IMART>
														<div class="input-group-append">
															<span class="input-group-text" id="fca7">個</span>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="col-3">
											<div class="row">
												<div class="col-6 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top radio_height"><nobr>初回生産予定数<span class="mark-req"> *</span></nobr></div>
												<div class="col-6 left-justified">
													<div class="input-group">
														<IMART type="input" style="text" maxlength="9" class="form-control radio_height nat-only text-number require" name="shokai_seisanyotei_su" id="shokai_seisanyotei_su" value=$item_data.shokai_seisanyotei_su ></IMART>
														<div class="input-group-append">
															<span class="input-group-text" id="fca8">個</span>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class="col-3">
											<div class="row">
												<div class="col-6 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top radio_height">SKU<span class="mark-req"> *</span></div>
												<div class="col-6 left-justified">
													<div class="input-group">
														<IMART type="input" style="text" maxlength="9" class="form-control radio_height nat-only text-number require" name="sku" id="sku" value=$item_data.sku oninput="" ></IMART>
														<div class="input-group-append">
															<span class="input-group-text" id="fca9">種</span>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-12 mt-2 mb-2">
									<div class="form-group row mb-3">
										<div class="col-2 t-header bg_ltorange brdr_dkgray text-center padding-top">地域<span class="mark-req"> *</span></div>
										<div class="col-2 left-justified">
											<imart type="imuiSelect" class="form-control chiiki_width radio_height" id="chiiki" name="chiiki" list=$chiikiList onChange="chiiki_chk" />
										</div>
									</div>
									<div class="form-group row sec2 sec3">
										<div class="col-8 col-lg-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top radio_height">初回生産予定数(内訳)</div>
										<div class="col-12 col-lg-10 row left-justified">
											<div class="col-12 col-lg-4">
												<div class="input-group nowrap">
													<div class="input-group-prepend hanbaiyoteikosu-area">
														<span class="input-group-text" id="fca9">日本</span>
													</div>
													<imart type="input" style="text" maxlength="9" class="form-control itemcount form_width radio_height nat-only text-number" id="hanbaiyoteikosu_nihon" name="hanbaiyoteikosu_nihon"  value=$item_data.hanbaiyoteikosu_nihon oninput="" />
													<div class="input-group-append">
														<span class="input-group-text" id="fca9">個</span>
													</div>
												</div>
											</div>
											<div class="col-12 col-lg-4">
												<div class="input-group nowrap sec_tiiki1" style="display: none;">
													<div class="input-group-prepend hanbaiyoteikosu-area">
														<span class="input-group-text" id="fca10">中国本土</span>
													</div>
													<imart type="input" style="text" maxlength="9" class="form-control itemcount form_width radio_height nat-only text-number" id="hanbaiyoteikosu_chugoku" name="hanbaiyoteikosu_chugoku"  value=$item_data.hanbaiyoteikosu_chugoku oninput="" />
													<div class="input-group-append">
														<span class="input-group-text" id="fca10">個</span>
													</div>
												</div>
											</div>
											<div class="col-12 col-lg-4">
												<div class="input-group nowrap sec_tiiki1" style="display: none;">
													<div class="input-group-prepend hanbaiyoteikosu-area">
														<span class="input-group-text" id="fca11">アジア（中国本土除く）</span>
													</div>
													<imart type="input" style="text" maxlength="9" class="form-control itemcount form_width radio_height nat-only text-number" id="hanbaiyoteikosu_asia" name="hanbaiyoteikosu_asia"  value=$item_data.hanbaiyoteikosu_asia oninput="" />
													<div class="input-group-append">
														<span class="input-group-text" id="fca11">個</span>
													</div>
												</div>
											</div>
											<div class="col-12 col-lg-4">
												<div class="input-group nowrap sec_tiiki1" style="display: none;">
													<div class="input-group-prepend hanbaiyoteikosu-area">
														<span class="input-group-text" id="fca12">北米・中南米</span>
													</div>
													<imart type="input" style="text" maxlength="9" class="form-control itemcount form_width radio_height nat-only text-number" id="hanbaiyoteikosu_chunanbei" name="hanbaiyoteikosu_chunanbei"  value=$item_data.hanbaiyoteikosu_chunanbei oninput="" />
													<div class="input-group-append">
														<span class="input-group-text" id="fca12">個</span>
													</div>
												</div>
											</div>
											<div class="col-12 col-lg-4">
												<div class="input-group nowrap sec_tiiki1" style="display: none;">
													<div class="input-group-prepend hanbaiyoteikosu-area">
														<span class="input-group-text" id="fca13">ヨーロッパ</span>
													</div>
													<imart type="input" style="text" maxlength="9" class="form-control itemcount form_width radio_height nat-only text-number" id="hanbaiyoteikosu_europe" name="hanbaiyoteikosu_europe"  value=$item_data.hanbaiyoteikosu_europe oninput="" />
													<div class="input-group-append">
														<span class="input-group-text" id="fca13">個</span>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="form-group row mt-2 mb-2 sec2 sec3 sec_tiiki1">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top sec_tiiki1 radio_height" style="display: none;">販売国詳細</div>
										<div class="col-10 sec_tiiki1 left-justified" style="display: none;">
											<imart type="imuiTextArea" maxlength="1000" class="form-control radio_height" id="hanbaikoku_shosai" name="hanbaikoku_shosai"  value=$item_data.hanbaikoku_shosai placeholder="※販売国詳細（WWの場合のみ）" rows="1" />
										</div>
									</div>
								</div>
								
								<div class="col-12 border-bottom mb-2 sec_tiiki1" style="display: none;">
									<div class="form-group row mb-3">
										<div class="col-2 t-header bg_ltorange brdr_dkgray text-center padding-top">ローカライズ商品名の有無<span class="mark-req"> *</span></div>
										<div class="col-2 left-justified">
											<imart type="imuiSelect" class="form-control chiiki_width radio_height" id="localize_shohin_umu" name="localize_shohin_umu" list=$localizeShohinUmuList onChange="localizeShohinUmu_chk" disabled="true" />
										</div>
									</div>
									<div class="form-group row mb-2 sec_localize_shohin" style="display: none;">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top line-height">ローカライズ商品名<span class="mark-req"> *</span></div>
										<div class="col-10 mb-2 left-justified">
											<imart type="imuiTextArea" maxlength="100" class="form-control require" name="localize_shohin_nm" id="localize_shohin_nm" value=$item_data.localize_shohin_nm placeholder="『有り』をご選択の場合は、ローカライズする言語すべて、必ず記入をお願いいたします。
※ご記入ない場合は簡易商標調査が行えません。
ローカライズはされるが、商品名が決まっていない場合は未定の旨ご記載ください。" rows="3" disabled="true" />
										</div>
									</div>
								</div>
								
								<div class="col-12 border-bottom mt-2 mb-2">
									<div class="form-group row mb-2 sec3">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top radio_height">発売時期<span class="mark-req"> *</span></div>
										<div class="col-4 left-justified licensePro-hide">
											<div class="input-group">
												<imart type="input" maxlength="10" style="text" class="form-control radio_height require" id="hanbai_jiki" name="hanbai_jiki" value=$item_data.hanbai_jiki />
												<imart type="imuiCalendar" changeYear="true" changeMonth="true" floatable="true" altField="#hanbai_jiki" showMonthAfterYear="true" zIndex="1000" onSelect="onSelectCalender" />
												<div class="input-group-append">
													<span class="input-group-text"><i class="fa fa-calendar"></i></span>
												</div>
											</div>
										</div>
										<div class="col-4 left-justified licensee-hide">
											<div class="input-group">
												<imart type="input" maxlength="10" style="text" class="form-control radio_height" id="hanbai_jiki_pro" name="hanbai_jiki_pro" value=$item_data.hanbai_jiki readonly/>
												<div class="input-group-append">
													<span class="input-group-text"><i class="fa fa-calendar"></i></span>
												</div>
											</div>
										</div>
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top radio_height">情報初出時期<span class="mark-req"> *</span></div>
										<div class="col-4 left-justified licensePro-hide">
											<div class="input-group">
												<imart type="input" maxlength="10" style="text" class="form-control radio_height require" id="jyouhou_syosyutu_jiki" name="jyouhou_syosyutu_jiki" value=$item_data.jyouhou_syosyutu_jiki />
												<imart type="imuiCalendar" changeYear="true" changeMonth="true" floatable="true" altField="#jyouhou_syosyutu_jiki" showMonthAfterYear="true" zIndex="1000" onSelect="onSelectCalender" />
												<div class="input-group-append">
													<span class="input-group-text"><i class="fa fa-calendar"></i></span>
												</div>
											</div>
										</div>
										<div class="col-4 left-justified licensee-hide">
											<div class="input-group">
												<imart type="input" maxlength="10" style="text" class="form-control radio_height" id="jyouhou_syosyutu_jiki_pro" name="jyouhou_syosyutu_jiki_pro" value=$item_data.jyouhou_syosyutu_jiki readonly/>
												<div class="input-group-append">
													<span class="input-group-text"><i class="fa fa-calendar"></i></span>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-12 mt-2 mb-2">
									<div class="form-group row mb-2 sec2 sec3">
										<div class="col-4">
											<div class="row">
												<div class="col-4 mb-2 t-header btn_include bg_ltorange brdr_dkgray text-center padding-top">売り場</div>
												<div class="col-8 mb-2">
													<div class="checkbox">
														<imart type="imuiCheckbox" value="1" name="uriba_tempo" id="uriba_tempo" checked=$chkbox_chk.uriba_tempo /><span class="blanc">店舗</span>
													</div>
													<div class="checkbox">
														<imart type="imuiCheckbox" value="1" name="uriba_ecsite" id="uriba_ecsite" checked=$chkbox_chk.uriba_ecsite /><span class="blanc">ECサイト販売</span>
													</div>
													<div class="checkbox">
														<imart type="imuiCheckbox" value="1" name="uriba_event" id="uriba_event" checked=$chkbox_chk.uriba_event /><span class="blanc">イベント</span>
													</div>
												</div>
											</div>
										</div>
										<div class="col-4">
											<div class="row">
												<div class="col-4 mb-2 t-header btn_include bg_ltorange brdr_dkgray text-center padding-top">売り方</div>
												<div class="col-8 mb-2">
													<div class="checkbox">
														<imart type="imuiCheckbox" value="1" name="urikata_ippanryutsu" id="urikata_ippanryutsu" checked=$chkbox_chk.urikata_ippanryutsu /><span class="blanc">一般流通</span><span class="blanc"><span class="mr-3"></span>
														<imart type="imuiCheckbox" value="1" name="urikata_juchuhambai" id="urikata_juchuhambai" checked=$chkbox_chk.urikata_juchuhambai /><span class="blanc">受注販売</span>
													</div>
													<div class="checkbox">
														<imart type="imuiCheckbox" value="1" name="urikata_senkohambai" id="urikata_senkohambai" checked=$chkbox_chk.urikata_senkohambai /><span class="blanc">先行販売</span><span class="blanc"><span class="mr-3"></span>
													</div>
													<div class="checkbox">
														<imart type="imuiCheckbox" value="1" name="urikata_tempo_kaijogenteihambai" id="urikata_tempo_kaijogenteihambai" checked=$chkbox_chk.urikata_tempo_kaijogenteihambai /><span class="blanc">店舗・会場限定販売</span>
													</div>
												</div>
											</div>
										</div>
										<div class="col-4">
											<div class="row">
												<div class="col-4 t-header bg_ltorange brdr_dkgray text-center padding-top">証紙 <span class="mark-req"> *</span></div>
												<div class="col-8 left-justified">
													<imart type="imuiSelect" class="form-control full_width require" id="shoshi" name="shoshi"  list=$shoshiList />
												</div>
											</div>
										</div>	
									</div>
								</div>
								<div class="col-12 border-bottom mt-2 mb-2">
									<div class="form-group row mb-2 sec2 sec3">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top line-height">主な販路</div>
										<div class="col-10 mb-2 left-justified">
											<imart type="imuiTextArea" maxlength="100" class="form-control" name="hanro" id="hanro" value=$item_data.hanro rows="5" />
										</div>
									</div>
								</div>
								<div class="col-12 border-bottom mt-2 mb-2">
									<div class="form-group row mb-3">
										<div class="col-12 col-lg-4">
											<div class="row">
												<div class="col-6 t-header bg_ltorange brdr_dkgray text-center padding-top">トレーディング仕様<span class="mark-req"> *</span></div>
												<div class="col-6 left-justified">
													<imart type="imuiSelect" class="form-control full_width require" id="trading" name="trading"  list=$tradingList />
												</div>
											</div>
										</div>
										<div class="col-12 col-lg-4">
											<div class="row">
												<div class="col-6 t-header bg_ltorange brdr_dkgray text-center padding-top">描き下ろし希望有無<span class="mark-req"> *</span></div>
												<div class="col-6 left-justified">
													<imart type="imuiSelect" class="form-control full_width require" id="kakiorosi_kibou_umu" name="kakiorosi_kibou_umu"  list=$kakioroshiList />
												</div>
											</div>
										</div>
										<div class="col-12 col-lg-4">
											<div class="row">
												<div class="col-7 t-header bg_ltorange brdr_dkgray text-center padding-top">アソビストアでの取り扱い希望<span class="mark-req"> *</span></div>
												<div class="col-5 left-justified">
													<imart type="imuiSelect" class="form-control full_width require" id="asobistore" name="asobistore"  list=$asobistoreList />
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-12 border-bottom mt-2 mb-2">
									<div class="form-group row mb-2 sec2 sec3">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top line-height">宣伝販促計画<span class="mark-req"> *</span></div>
										<div class="col-10 mb-2 left-justified">
											<imart type="imuiTextArea" maxlength="1000" class="form-control require" name="sendenhansoku_keikaku" id="sendenhansoku_keikaku" placeholder="" value=$item_data.sendenhansoku_keikaku rows="4" />
											<!-- <div class="txt_red sec3 fs11 mb-4">※販促物、特典がある場合は宣伝販促計画欄に内容を記載してください。</div> -->
										</div>
									</div>
								</div>
								<div class="col-12 row mt-2 mb-2">
									<h2>コンセプト・仕様</h2>
								</div>
								<!-- 対象年齢層、対象性別削除 -->
								<!--
								<div class="col-12 form-group row border-bottom mb-2">
									<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center">対象年齢層</div>
									<div class="col-4 mb-2 txt_dark">
										<select class="form-control" name="taisho_nenreisou" id="taisho_nenreisou" required>
											<option value="" class="msg" disabled selected>-----年齢層を選択-----</option>
										    <option value="1">全年齢</option>
										    <option value="2">10代未満</option>
											<option value="3">10代</option>
											<option value="4">20代</option>
											<option value="5">30代</option>
											<option value="6">40代</option>
											<option value="7">50代</option>
											<option value="8">60代以上</option>
										</select>
									</div>
									<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center">対象性別</div>
									<div class="col-4 mb-2">
										<div class="input-group">
											<div class="input-group-prepend">
												<span class="input-group-text" id="fca30">男</span>
											</div>
											<IMART type="input" style="text" class="form-control text-center" name="taisho_seibetsu_otoko"value=$item_data.taisho_seibetsu_otoko></IMART>
											<div class="input-group-append">
												<span class="input-group-text" id="fca30">：</span>
											</div>
											<IMART type="input" style="text" class="form-control text-center" name="taisho_seibetsu_onna"value=$item_data.taisho_seibetsu_onna></IMART>
											<div class="input-group-append">
												<span class="input-group-text" id="fca32">女</span>
											</div>
										</div>
									</div>
									</div>
									-->
								<div class="col-12 border-bottom mb-2 mt-2">
									<div class="form-group row mb-2 sec3">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top line-height">商品説明<span class="mark-req"> *</span></div>
										<div class="col-10 mb-2 left-justified">
											<imart type="imuiTextArea" maxlength="1000" class="form-control require" name="shohin_setsumei" id="shohin_setsumei" placeholder="商品の説明を記入してください" value=$item_data.shohin_setsumei rows="4" />
										</div>
									</div>
								</div>
								<div class="col-12 border-bottom mt-2 mb-2">
									<div class="form-group row mb-2 sec2 sec3">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top">材質<span class="mark-req"> *</span></div>
										<div class="col-4 mb-2 left-justified">
											<IMART type="input" style="text" maxlength="1000" class="form-control require" name="sozai" id="sozai" value=$item_data.sozai escapeXml="true" ></IMART>
										</div>
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top">サイズ<span class="mark-req"> *</span></div>
										<div class="col-4 mb-2 left-justified">
											<IMART type="input" style="text" maxlength="1000" class="form-control require" name="size" id="size" value=$item_data.size escapeXml="true" ></IMART>
										</div>
									</div>
								</div>
								<div class="col-12 border-bottom mt-2 mb-2" id="complete_images">
									<div class="col-6 form-group row mt-2 mb-2 licensePro-hide left-justified right-justified">
										<div class="fileupload-area">
											<div class="filesSelect imui-fileupload-area before_file_select">
												<div class="fileupload-input-caption">完成イメージを追加するにはここに画像をドラッグ&ドロップしてください</div>
												<!-- <label id="file_upload_btn" for="file_upload" class="filesUploadLabel">ファイルを選択</label> -->
											</div>
										</div>
									</div>
									<div class="col-6 form-group row mt-2 mb-2 licensePro-hide left-justified right-justified">
										<span class="col-12"><imart type="string" value=$extstr /></span>
										<span class="col-12"><imart type="message" id="IN01I007" escapeJs="true" /></span>
									</div>
									<!-- 初期表示兼テンプレートエリア -->
									<div class="form-group row mb-2 sec2 sec3 completeImage completeImageTemplate">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center" style="line-height: 300px;">完成イメージ</div>
										<div class="col-4 mb-2 left-justified imui-fileupload-area before_file_select">
											<div class="fileupload-area" style="height: 100%; margin: 0px;">
												<div class="afterFileSelect">
													<div class="thumbnail imgFile">
													</div>
													<dl>
														<dt class="upfilename">
															<span class="upfilenametext"><imart type="string" value="" /></span>
														</dt>
														<imart type="hidden" item_upFile_name="" />
														<imart type="hidden" item_upFile_resname="" />
														<dd>
															<a href="javascript: void(0);" onclick="upFileDel(this)" style="display: none;">
																<span class="fas fa-trash-alt fa-1x"></span>
															</a>
														</dd>
													</dl>
												</div>
											</div>
										</div>
										<!-- THATS_RIGHTS-1160により削除
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center" style="line-height: 300px;">コメント<span class="mark-req"> *</span></div>
										<div class="col-4 mb-2 left-justified">
											<imart type="imuiTextArea" class="form-control require" name="comment"　value="" maxlength="10000" rows="12" />
										</div>
										-->
									</div>
									<!-- 動的追加エリア -->
									<imart type="repeat" list=$fileList item="item" index="idx">
									<div class="form-group row mb-2 sec2 sec3 completeImage">
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center" style="line-height: 300px;">完成イメージ</div>
										<div class="col-4 mb-2 left-justified imui-fileupload-area before_file_select">
											<div class="fileupload-area" style="height: 100%; margin: 0px;">
												<div class="afterFileSelect">
													<div class="thumbnail imgFile">
														<a href='lo/contents/screen/pub_file_dl?filePath=<imart type="string" value=item.file_path />&fileName=<imart type="string" value=item.file_name  escapeXml="true"/>' download>
															<img class="img-responsive" src='lo/contents/screen/pub_file_dl?filePath=<imart type="string" value=item.file_path />&fileName=<imart type="string" value=item.file_name escapeXml="true"/>' onerror="changeImgToIcon(this,'<imart type="string" value=item.file_name />')" />
														</a>
													</div>
													<dl>
														<dt class="upfilename">
															<a href='lo/contents/screen/pub_file_dl?filePath=<imart type="string" value=item.file_path />&fileName=<imart type="string" value=item.file_name escapeXml="true"/>' download>
																<span class="upfilenametext"><imart type="string" value=item.file_name /></span>
															</a>
														</dt>
														<imart type="hidden" item_upFile_name=item.file_name />
														<imart type="hidden" item_upFile_resname=item.file_path />
														<dd class="licensePro-hide shanaiShusei-hide">
															<a href="javascript: void(0);" onclick="upFileDel(this)">
																<span class="fas fa-trash-alt fa-1x"></span>
															</a>
														</dd>
													</dl>
												</div>
											</div>
										</div>
										<!-- THATS_RIGHTS-1160により削除
										<div class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center" style="line-height: 300px;">コメント<span class="mark-req"> *</span></div>
										<div class="col-4 mb-2 left-justified">
											<imart type="imuiTextArea" class="form-control require" name="comment"　id="comment"　value=item.comment maxlength="10000" rows="12" />
										</div>
										-->
									</div>
									</imart>
								</div>
								<div class="col-12 row mt-2 mb-2">
									<h2>備考<span class="ml-3">※補足情報があればこちらに記入してください</span></h2>
								</div>
								<div class="col-12 border-bottom mb-2 mt-2">
									<div class="form-group row mb-2 sec3">
										<div id="ichizi_bikou" class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top line-height">備考</div>
										<div id="syuusei_bikou" class="col-2 mb-2 t-header bg_ltorange brdr_dkgray text-center padding-top line-height" style="display:none;">備考<span class="mark-req"> *</span></div>
										<div class="col-10 mb-2 left-justified">
											<imart type="imuiTextArea" class="form-control require" name="bikou" id="bikou" value=$item_data.bikou maxlength="10000" rows="8" 
											placeholder="・販売国と商品・キャラクター名（種類数）をご記入ください。
・色違いの商品がある、特殊な加工方法を検討している（Tシャツのプリントなど）場合には、その旨もご記入ください。
・同じ商品カテゴリーで発売月や価格が同じ場合、同じチケットで申請可能です（アパレルは除く）。
　記入例）
　　「アイドルマスター シンデレラガールズ アクリルキーホルダー 島村卯月」1SKU 10月発売 800円
　　「アイドルマスター シンデレラガールズ アクリルキーホルダー 渋谷凛」　1SKU 10月発売 800円…
　※「アイドルマスター シンデレラガールズ アクリルキーホルダー」として1つの企画チケット（企画商品登録画面）に
　　ご入力いただき、SKU数を2、備考に詳細をご記入の上申請いただけます。" />
										</div>
										
									</div>
									<div id="annotation_bikou" class="mb-2" style="display:none;">
										修正依頼を受けて内容を変更した場合は以下のように変更内容が分かるよう記載のご協力をお願いします<br>
										例） 税抜上代：1000→1500
									</div>
								</div>
							</section>
							<section class="show licensePro_color">
								<!-- ライセンスプロダクションのみ表示 -->
								<IMART type="condition" validity=$production_flg>
									<div class="col-12 row mt-2 mb-2">
										<h2>ライセンスプロダクション入力欄<span class="ml-3">※社内ユーザのみ参照できます</span></h2>
									</div>
									<div class="col-12 border-bottom mt-2 mb-2">
										<div class="form-group row mb-2 sec3">
											<div class="col-2 mb-2 t-header bg_ltblue brdr_dkgray text-center padding-top">素材見積もり</div>
											<div class="col-2 mb-2 left-justified">
												<div class="input-group">
													<IMART type="input" style="text" maxlength="9" class="form-control mask_money radio_height nat-only text-number" name="sozai_mitsumori" id="sozai_mitsumori" value=$item_data.sozai_mitsumori oninput="" ></IMART>
													<div class="input-group-append">
														<span class="input-group-text" id="fca41">円</span>
													</div>
												</div>
											</div>
											<div class="col-2 mb-2 t-header bg_ltblue brdr_dkgray text-center padding-top">料率</div>
											<div class="col-2 mb-2 left-justified">
												<div class="input-group">
													<IMART type="input" style="text" maxlength="9" class="form-control mask_money radio_height num-only text-decimal" name="ryouritu" id="ryouritu" value=$item_data.ryouritu oninput="" ></IMART>
													<div class="input-group-append">
														<span class="input-group-text" id="fca42">%</span>
													</div>
												</div>
											</div>
											<div class="col-2 mb-2 t-header bg_ltblue brdr_dkgray text-center padding-top">サンプル数</div>
											<div class="col-2 mb-2 left-justified">
												<div class="input-group">
													<IMART type="input" style="text" maxlength="9" class="form-control mask_money radio_height nat-only text-number" name="sample" id="sample" value=$item_data.sample oninput="" ></IMART>
													<div class="input-group-append">
														<span class="input-group-text" id="fca43">個</span>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="col-12 border-bottom mt-2 mb-2">
										<div class="form-group row mb-2 sec3">
											<div class="col-2 mb-2 t-header bg_ltblue brdr_dkgray text-center padding-top">理由・条件</div>
											<div class="col-10 mb-2 left-justified">
												<imart type="imuiTextArea" maxlength="1000" class="form-control" name="riyu_joken" id="riyu_joken" placeholder="" value=$item_data.riyu_joken rows="4" />
											</div>
										</div>
									</div>
									<div class="col-12 border-bottom mt-2 mb-2">
										<div class="form-group row mb-2">
											<div class="col-2 mb-2 t-header bg_ltblue brdr_dkgray text-center padding-top">承認</div>
											<div class="col-2 left-justified">
												<imart type="imuiSelect" class="form-control full_width" id="ok_ng" name="ok_ng" list=$shoninList />
											</div>
											<div class="col-4"></div>
											<div class="col-2 mb-2 t-header bg_ltblue brdr_dkgray text-center padding-top">ロイヤリティ金額</div>
											<div class="col-2 mb-2 left-justified">
												<div class="input-group">
													<IMART type="input" style="text" maxlength="9" class="form-control mask_money radio_height nat-only" name="royalty_kingaku" id="royalty_kingaku" value=$item_data.royalty_kingaku disabled="true"></IMART>
													<div class="input-group-append">
														<span class="input-group-text">円</span>
													</div>
												</div>
											</div>
										</div>
									</div>
								</IMART>
								</section>
								
								<!-- エラー表示エリア -->
								<div class="row">
									<div id="error-messages" class="col-12 mt-4 mb-2">
									</div>
								</div>
								
								<section class="show">
									<div class="col-12 form-group border-bottom row mt-2 mb-2">
										<div class="flex_btn">
											<div class="col-12">
												<button type="button" id="btn_save" class="bg_orange txt_dark mb-2"><i class="fas fa-check "></i><span>登録</span></button>
											</div>
										</div>
									</div>
								</section>
							</div>
						</form>
						
						<div class="ml-4">
							<button type="button" class="brdr_orange txt_orange p-3 mb-2" onclick="moveToPageTop(100);">
								▲ページ先頭へ戻る
							</button>
						</div>
						
					</div>
				</div>
			</div>
		</article>
				<div>
					<article>
						<section class="show">
							<footer class="text-center mt-4 mb-2"></footer>
						</section>
					</article>
				</div>
			</div>
		</div>
	</div>

	<!-- ファイルアップロードエリア -->
	<form id="filesForm" name="filesForm" action="ui/filer/upload" method="POST" enctype="multipart/form-data">
		<div style="display:none;">
			<!-- ストレージサービスへのファイルのアップロード（IM標準） -->
			<imart type="imuiFileUpload" 
				storeTo="/lo/upload"
				autoUpload="true" 
				uniqueFileName="true" 
				id="imui-upload"
				onBeforeSend="onBeforeSendFiles" 
				onSuccess="onSuccessFiles"
				onError="onErrorFiles" 
				outerFormId="filesForm"
				dropZone=".before_file_select" />
				<imst:imSecureToken />
		</div>
	</form>
	 
<script type="text/javascript">
	//企画ステータス取得
	var kikaku_status = <imart type="string" value=$kikaku_status />;
	
	var validationErrorMessages = <imart type="string" value=$validationErrorMessages />;
	function validate() {
		var validationRules = [
			{type: "single", dataCategory: "basic",
				items: [	
					{selectorType: "name", name: "shohin_category", validations:[{type: "required", messageId: "KK03E001"}]},
					{selectorType: "name", name: "shohin_nm", validations:[{type: "required", messageId: "KK03E002"}]},
					{selectorType: "name", name: "zeinuki_jodai", validations:[{type: "required", messageId: "KK03E003"}]},
                    {selectorType: "name", name: "zeinuki_jodai", validations:[{type: "num5", messageId: "KK03E020"}]},
					{selectorType: "name", name: "zeinuki_jodai", validations:[{type: "space", messageId: "KK03E040"}]},
					{selectorType: "name", name: "mokuhyo_hambai_su", validations:[{type: "required", messageId: "KK03E004"}]},
					{selectorType: "name", name: "mokuhyo_hambai_su", validations:[{type: "nat", messageId: "KK03E021"}]},
					{selectorType: "name", name: "mokuhyo_hambai_su", validations:[{type: "space", messageId: "KK03E041"}]},
					{selectorType: "name", name: "mokuhyo_hambai_su", validations:[{type: "individual", messageId: "KK03E034"}]},
					{selectorType: "name", name: "shokai_seisanyotei_su", validations:[{type: "required", messageId: "KK03E005"}]},
					{selectorType: "name", name: "shokai_seisanyotei_su", validations:[{type: "nat", messageId: "KK03E022"}]},
					{selectorType: "name", name: "shokai_seisanyotei_su", validations:[{type: "space", messageId: "KK03E042"}]},
					{selectorType: "name", name: "sku", validations:[{type: "required", messageId: "KK03E006"}]},
					{selectorType: "name", name: "sku", validations:[{type: "nat", messageId: "KK03E023"}]},
					{selectorType: "name", name: "sku", validations:[{type: "space", messageId: "KK03E043"}]},
					{selectorType: "name", name: "chiiki", validations:[{type: "required", messageId: "KK03E007"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_nihon", validations:[{type: "nat", messageId: "KK03E024"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_nihon", validations:[{type: "space", messageId: "KK03E044"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_chugoku", validations:[{type: "nat", messageId: "KK03E025"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_chugoku", validations:[{type: "space", messageId: "KK03E045"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_asia", validations:[{type: "nat", messageId: "KK03E026"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_asia", validations:[{type: "space", messageId: "KK03E046"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_chunanbei", validations:[{type: "nat", messageId: "KK03E027"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_chunanbei", validations:[{type: "space", messageId: "KK03E047"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_europe", validations:[{type: "nat", messageId: "KK03E028"}]},
					{selectorType: "name", name: "hanbaiyoteikosu_europe", validations:[{type: "space", messageId: "KK03E048"}]},
					{selectorType: "name", name: "hanbai_jiki", validations:[{type: "required", messageId: "KK03E008"}]},
					{selectorType: "name", name: "hanbai_jiki", validations:[{type: "calender", messageId: "KK03E035"}]},
					{selectorType: "name", name: "jyouhou_syosyutu_jiki", validations:[{type: "required", messageId: "KK03E009"}]},
					{selectorType: "name", name: "jyouhou_syosyutu_jiki", validations:[{type: "calender", messageId: "KK03E036"}]},
					{selectorType: "name", name: "jyouhou_syosyutu_jiki", validations:[{type: "calender_from", messageId: "KK03E037"}]},
					{selectorType: "name", name: "shoshi", validations:[{type: "required", messageId: "KK03E010"}]},
					{selectorType: "name", name: "trading", validations:[{type: "required", messageId: "KK03E011"}]},
					{selectorType: "name", name: "kakiorosi_kibou_umu", validations:[{type: "required", messageId: "KK03E012"}]},
					{selectorType: "name", name: "asobistore", validations:[{type: "required", messageId: "KK03E013"}]},
					{selectorType: "name", name: "sendenhansoku_keikaku", validations:[{type: "required", messageId: "KK03E014"}]},
					{selectorType: "name", name: "shohin_setsumei", validations:[{type: "required", messageId: "KK03E015"}]},
					{selectorType: "name", name: "sozai", validations:[{type: "required", messageId: "KK03E016"}]},
					{selectorType: "name", name: "size", validations:[{type: "required", messageId: "KK03E017"}]},
					{selectorType: "name", name: "sozai_mitsumori", validations:[{type: "nat", messageId: "KK03E029"}]},
					{selectorType: "name", name: "sozai_mitsumori", validations:[{type: "space", messageId: "KK03E049"}]},
					{selectorType: "name", name: "ryouritu", validations:[{type: "num", messageId: "KK03E030"}]},
					{selectorType: "name", name: "ryouritu", validations:[{type: "space", messageId: "KK03E050"}]},
					{selectorType: "name", name: "sample", validations:[{type: "nat", messageId: "KK03E031"}]},
					{selectorType: "name", name: "sample", validations:[{type: "space", messageId: "KK03E051"}]},
					{selectorType: "name", name: "localize_shohin_nm", validations:[{type: "required", messageId: "KK03E052"}]}
				]
			},
			{type: "grid", dataCategory: "complateImage",  rowSelector: "#complete_images div.completeImage:visible",
				items: []
			}
		];
		
		if (kikaku_status == '3') {
			validationRules[0].items.push({selectorType: "name", name: "bikou", validations:[{type: "required", messageId: "KK03E038"}]});
		}
		
		var natNgList = chkInputNatOnly();
		var numNgList = chkInputNumOnly();
		var spaceNgList = chkInputSpace();
		
		var validateItem = function(itemName, $item, validations, index) {
			var result = [];
			if ($item.is(':disabled')) {
				return result;
			}
			for (var validationIndex in validations) {
				var validation = validations[validationIndex];
				var messageId = null;
				if (validation.type == "required") {
					if ($item.is(":radio") || $item.is(":checkbox")) {
						var checked = false;
						$item.each(function(index, element) {
							var $element = $(element);
							if ($element.is(":checked")) {
								checked = true;
								return false;
							}
						});
						if (checked == false) {
							messageId = validation.messageId;
						}
					} else {
						if ($item.length == 0 || $item.val() == '') {
							messageId = validation.messageId;
						}
					}
				}
				if (validation.type == "simplex" || validation.type == "unique") {
					var uniqueArray = [];
					$item.each(function(index, element) {
						var $element = $(element);
						if (uniqueArray.indexOf($element.val()) < 0) {
							uniqueArray.push($element.val());
						}
					});
					if (validation.type == "unique") {
						if ($item.length != uniqueArray.length) {
							messageId = validation.messageId;
						}
					}
					if (validation.type == "simplex") {
						if (uniqueArray.length > 1) {
							messageId = validation.messageId;
						}
					}
				}
				if (validation.type == "nat") {
					if(natNgList.indexOf($item[0]) >= 0) messageId = validation.messageId;
				}
				if (validation.type == "num") {
					if(numNgList.indexOf($item[0]) >= 0) messageId = validation.messageId;
				}
                if (validation.type == "num5") {
                    if(numNgList.indexOf($item[0]) >= 0) messageId = validation.messageId;
                    var zeinuki_jodai_1 = $("[name=zeinuki_jodai]").val() ? parseFloat(convertWideToHalf($("[name=zeinuki_jodai]").val()).replace(/,/g, '')) : 0;
                    var zeinuki_jodai_2 = parseFloat(zeinuki_jodai_1.toFixed(5));
                    if(zeinuki_jodai_1 != zeinuki_jodai_2) messageId = validation.messageId;
                }
				if (validation.type == "space") {
					if(spaceNgList.indexOf($item[0]) >= 0) messageId = validation.messageId;
				}
                if (validation.type == "individual") {
                    if (itemName == "mokuhyo_hambai_su") {
                        let mokuhyo_hambai_su = $("[name=mokuhyo_hambai_su]").val() ? parseInt(convertWideToHalf($("[name=mokuhyo_hambai_su]").val()).replace(/,/g, ''), 10) : 0;
                        let hanbaiyoteikosu_nihon = $("[name=hanbaiyoteikosu_nihon]").val() ? parseInt(convertWideToHalf($("[name=hanbaiyoteikosu_nihon]").val()).replace(/,/g, ''), 10) : 0;
                        let hanbaiyoteikosu_chugoku = $("[name=hanbaiyoteikosu_chugoku]").val() ? parseInt(convertWideToHalf($("[name=hanbaiyoteikosu_chugoku]").val()).replace(/,/g, ''), 10) : 0;
                        let hanbaiyoteikosu_asia = $("[name=hanbaiyoteikosu_asia]").val() ? parseInt(convertWideToHalf($("[name=hanbaiyoteikosu_asia]").val()).replace(/,/g, ''), 10) : 0;
                        let hanbaiyoteikosu_chunanbei = $("[name=hanbaiyoteikosu_chunanbei]").val() ? parseInt(convertWideToHalf($("[name=hanbaiyoteikosu_chunanbei]").val()).replace(/,/g, ''), 10) : 0;
                        let hanbaiyoteikosu_europe = $("[name=hanbaiyoteikosu_europe]").val() ? parseInt(convertWideToHalf($("[name=hanbaiyoteikosu_europe]").val()).replace(/,/g, ''), 10) : 0;
                        let hanbaiyoteikosu = hanbaiyoteikosu_nihon;
						if ($("#chiiki").val() == "2") {
							hanbaiyoteikosu += hanbaiyoteikosu_chugoku + hanbaiyoteikosu_asia + hanbaiyoteikosu_chunanbei + hanbaiyoteikosu_europe;
						}
                        if (typeof mokuhyo_hambai_su == "number" && typeof hanbaiyoteikosu == "number") {
                            if(mokuhyo_hambai_su < hanbaiyoteikosu) {
                                messageId = validation.messageId;
                            }
                        }
                    }
                }
                if (validation.type == "calender") {
                	if (!$item.val() == '' && !$item.val().match(/^[0-9]{4}\/[0-9]{2}\/[0-9]{2}$/)) {
                		messageId = validation.messageId;
                	}
                }
                if (validation.type == "calender_from") {
                	let hanbai_jiki = $("[name=hanbai_jiki]") ? parseInt($("[name=hanbai_jiki]").val().replace(/\//g, "").replace(/,/g, '')) : 0;
                	let jyouhou_syosyutu_jiki = $("[name=jyouhou_syosyutu_jiki]") ? parseInt($("[name=jyouhou_syosyutu_jiki]").val().replace(/\//g, "").replace(/,/g, '')) : 0;
                	if (hanbai_jiki < jyouhou_syosyutu_jiki) {
                		messageId = validation.messageId;
                	}
                }
				if (messageId != null) {
					var errorMessage = validationErrorMessages[messageId];
					if (typeof index != "undefined") {
						errorMessage = errorMessage.replace("{0}", "#" + (index + 1));
					}
					result.push({itemName: itemName, type: validation.type, messageId: messageId, errorMessage:　errorMessage});
					break;
				}
			}
			return result;
		}

		var validateItems = function($container, items, index) {
			var allResult = [];
			for (var itemKey in items) {
				var validationItem = items[itemKey];
				var selectorType = validationItem.selectorType;
				var itemName = validationItem.name;
				var validations = validationItem.validations;
				var $item = $container.find(selectorType == 'class' ? '.' + itemName : '[name="' + itemName + '"]');
				var result = validateItem(itemName, $item, validations, index);
				allResult = allResult.concat(result);
			}
			return allResult;
		}

		var validateResult = {
			isError: false,
			itemResults: []
		};
		for (var typeKey in validationRules) {
			var ruleType = validationRules[typeKey];
			if (ruleType.type == 'grid') {
				var $rows = $(ruleType.rowSelector);
				$rows.each(function(index, element) {
					var $row = $(element);
					var result = validateItems($row, ruleType.items, index);
					validateResult.itemResults = validateResult.itemResults.concat(result);
				});
			} else {
				var $body = $("body");
				var result = validateItems($body, ruleType.items);
				validateResult.itemResults = validateResult.itemResults.concat(result);
			}
		}
		if (validateResult.itemResults.length > 0) {
			validateResult.isError = true;
		}
		return validateResult;
	}

	function validateAndShowMessage() {
		var $errorMessages = $("#error-messages");
		$errorMessages.empty();
		var validateResult = validate();
		if (validateResult.isError == false) {
			// ボタン活性化
			document.getElementById("btn_save").disabled = false;
			return validateResult;
		}
		var showMessages = [];
		validateResult.itemResults.forEach(function(currentValue, index, array){
			if (showMessages.indexOf(currentValue.errorMessage) < 0) {
				showMessages.push(currentValue.errorMessage);
			}
		});
		for (var index in showMessages) {
			var message = showMessages[index];
			var messageHtml = '<div class="mark-req">' + message + '</div>';
			$errorMessages.append(messageHtml);
		}
		validateResult.showMessages = showMessages;
		
		// ボタン非活性化
		if (showMessages.length > 0){
			document.getElementById("btn_save").disabled = true;
		}
		
		return validateResult;
	}

	//登録後処理
	function editCallback(ret){
		// 詳細画面へ遷移
		if (ret.error){
			hideIndicator();
			alert(ret.msg);
		}else{
			// URLにパラメータを付与
			let crntUrl = window.location.pathname;
			let crntParamIdx = crntUrl.indexOf('?');
			if(crntParamIdx > 0) crntUrl = crntUrl.substring(0,crntParamIdx);
			window.history.replaceState(null,null,crntUrl + '?kikaku_id=' + ret.kikaku_id + '&kikaku_edaban=' + ret.kikaku_edaban);
			// THATS_RIGHTS-1312 【UAT指摘】ダイアログ「更新しました」は余計
			//alert(ret.altmsg);
			// 参照画面へ遷移
    		history.back();
		}
	}
	// 登録時エラー
	function editError(ex) {
		hideIndicator();
		imuiShowErrorMessage(ex.message, [], true, 5000, true);
	}

	// 初期表示
	function initDisp() {
		
		// プルダウン初期設定
		// 値取得
		var kikaku_chiiki = '<imart type="string" value=$item_data.chiiki />';
		var shoshi = '<imart type="string" value=$item_data.shoshi />';
		var trading = '<imart type="string" value=$item_data.trading />';
		var kakiorosi_kibou_umu = '<imart type="string" value=$item_data.kakiorosi_kibou_umu />';
		var asobistore = '<imart type="string" value=$item_data.asobistore />';
		var ok_ng = '<imart type="string" value=$item_data.ok_ng />';
		var localize_shohin_umu = '<imart type="string" value=$item_data.localize_shohin_umu />'

		// lo-commonで定義したフォーカスアウトを発火
		initializeNumFormat();

		// 表示設定
		var select = document.getElementById("chiiki");
		if(kikaku_chiiki == '2') {
			$('[name=hanbaiyoteikosu_nihon]').prop('disabled',false);
			$('.sec_tiiki1').show();
			select.options[2].selected = true;
		} else if(kikaku_chiiki == '1') {
			$('[name=hanbaiyoteikosu_nihon]').prop('disabled',true);
			linkShokaiSeisanYoteisu();
			$('.sec_tiiki1').hide();
			select.options[1].selected = true;
		} else {
			$('[name=hanbaiyoteikosu_nihon]').prop('disabled',true);
			select.options[0].selected = true;
			$('.sec_tiiki1').hide();
		}
		select = document.getElementById("localize_shohin_umu");
		if($('#chiiki').val() == '2') {
			$('#localize_shohin_umu').prop('disabled', false);
			if (localize_shohin_umu == '1') {
				select.options[0].selected = true;
				$('.sec_localize_shohin').show();
				$('#localize_shohin_nm').prop('disabled', false);
			} else if (localize_shohin_umu == '0') {
				select.options[1].selected = true;
				$('.localize_shohin_nm').hide();
			} else {
				select.options[0].selected = true;
				$('.sec_localize_shohin').show();
				$('#localize_shohin_nm').prop('disabled', false);
			}
		}
		select = document.getElementById("shoshi");
		if(shoshi == '1') {
			select.options[1].selected = true;
		} else if(shoshi == '2') {
			select.options[2].selected = true;
		} else if(shoshi == '3') {
			select.options[3].selected = true;
		} else {
			select.options[0].selected = true;
		}
		select = document.getElementById("trading");
		if(trading == '1') {
			select.options[1].selected = true;
		} else if(trading == '2') {
			select.options[2].selected = true;
		} else {
			select.options[0].selected = true;
		}
		select = document.getElementById("kakiorosi_kibou_umu");
		if(kakiorosi_kibou_umu == '1') {
			select.options[1].selected = true;
		} else if(kakiorosi_kibou_umu == '2') {
			select.options[2].selected = true;
		} else {
			select.options[0].selected = true;
		}
		select = document.getElementById("asobistore");
		if(asobistore == '1') {
			select.options[1].selected = true;
		} else if(asobistore == '2') {
			select.options[2].selected = true;
		} else {
			select.options[0].selected = true;
		}
		
		// ライセンスプロダクションでない場合
		<IMART type="condition" validity=$production_flg negative>
			$('.licensee-hide').hide(); // ライセンスプロダクション用の項目を非表示
		</IMART>
		
		// ライセンスプロダクションの場合、読み取り専用にする
		<IMART type="condition" validity=$production_flg>
			
			// 表示設定
			select = document.getElementById("ok_ng");
			if(ok_ng == '0'){
				select.options[0].selected = true;
			} else if(ok_ng == '1') {
				select.options[1].selected = true;
			} else if(ok_ng == '2') {
				select.options[2].selected = true;
			}

			<imart type="condition" validity=$shanaiShuseiFlg>
				// 社内修正の場合は、ライセンシーと同様に修正可能とする(一部修正不可)
				$('.licensee-hide').hide();
				$('#complete_images > .licensePro-hide').hide();
				$('.shanaiShusei-hide').hide();
			</imart>

			<imart type="condition" validity=$shanaiShuseiFlg negative>
				$('.licensePro-hide').hide(); // ライセンシー用の項目を非表示
				
				document.getElementById("shohin_nm").readOnly = true;
				document.getElementById("zeinuki_jodai").readOnly = true;
				document.getElementById("mokuhyo_hambai_su").readOnly = true;
				document.getElementById("shokai_seisanyotei_su").readOnly = true;
				document.getElementById("sku").readOnly = true;
				document.getElementById("chiiki").options[0].disabled = true;
				document.getElementById("chiiki").options[1].disabled = true;
				document.getElementById("chiiki").options[2].disabled = true;
				document.getElementById("hanbaiyoteikosu_nihon").readOnly = true;
				document.getElementById("hanbaiyoteikosu_chugoku").readOnly = true;
				document.getElementById("hanbaiyoteikosu_asia").readOnly = true;
				document.getElementById("hanbaiyoteikosu_chunanbei").readOnly = true;
				document.getElementById("hanbaiyoteikosu_europe").readOnly = true;
				document.getElementById("hanbaikoku_shosai").readOnly = true;
				document.getElementById("hanbai_jiki").readOnly = true;
				document.getElementById("jyouhou_syosyutu_jiki").readOnly = true;
				document.getElementById("uriba_tempo").disabled = true;
				document.getElementById("uriba_event").disabled = true;
				document.getElementById("uriba_ecsite").disabled = true;
				document.getElementById("urikata_ippanryutsu").disabled = true;
				document.getElementById("urikata_juchuhambai").disabled = true;
				document.getElementById("urikata_senkohambai").disabled = true;
				document.getElementById("urikata_tempo_kaijogenteihambai").disabled = true;
				document.getElementById("hanro").readOnly = true;
				document.getElementById("shoshi").options[0].disabled = true;
				document.getElementById("shoshi").options[1].disabled = true;
				document.getElementById("shoshi").options[2].disabled = true;
				document.getElementById("shoshi").options[3].disabled = true;
				document.getElementById("trading").options[0].disabled = true;
				document.getElementById("trading").options[1].disabled = true;
				document.getElementById("trading").options[2].disabled = true;
				document.getElementById("kakiorosi_kibou_umu").options[0].disabled = true;
				document.getElementById("kakiorosi_kibou_umu").options[1].disabled = true;
				document.getElementById("kakiorosi_kibou_umu").options[2].disabled = true;
				document.getElementById("asobistore").options[0].disabled = true;
				document.getElementById("asobistore").options[1].disabled = true;
				document.getElementById("asobistore").options[2].disabled = true;
				document.getElementById("sendenhansoku_keikaku").readOnly = true;
				document.getElementById("shohin_setsumei").readOnly = true;
				document.getElementById("sozai").readOnly = true;
				document.getElementById("size").readOnly = true;
				document.getElementById("bikou").readOnly = true;
			</imart>
		</IMART>
		
		// 企画ステータス毎の設定
		var action_url = '';
		if (kikaku_status == '2') {
			action_url = 'lo/contents/screen/kikaku/planning_detail_new';
		} else if (kikaku_status == '3') {
			action_url = 'lo/contents/screen/kikaku/planning_form_new';
			$('#annotation_bikou').show();
			$('#ichizi_bikou').hide();
			$('#syuusei_bikou').show();
			$('#bikou').addClass('require');
		} else {
			action_url = 'lo/contents/screen/kikaku/planning_form_new';
		}
		$('#sendFrom').attr("action",action_url);
		
		// フォーム内にあるname属性と入力値を一括で取得する
		var param = $('#inputFrom').serializeInputValue();
		
		// 表示設定
		if ($(".completeImage:not(.completeImageTemplate)").length > 0) {
			$(".completeImageTemplate").hide();
		}
		// 必須項目チェック
    	validateAndShowMessage();
	}
    $(function () {
    	
    	// 初期表示
		initDisp();

     	// 企画申請登録ボタン押下時
        $('#btn_save').click(function () {
        	showIndicator();
        	
        	// チェックボタン、ラジオボタンの有効化
        	<IMART type="condition" validity=$production_flg>
				document.getElementById("uriba_tempo").disabled = false;
				document.getElementById("uriba_event").disabled = false;
				document.getElementById("uriba_ecsite").disabled = false;
				document.getElementById("urikata_ippanryutsu").disabled = false;
				document.getElementById("urikata_juchuhambai").disabled = false;
				document.getElementById("urikata_senkohambai").disabled = false;
				document.getElementById("urikata_tempo_kaijogenteihambai").disabled = false;
				document.getElementById("chiiki").options[0].disabled = false;
				document.getElementById("chiiki").options[1].disabled = false;
				document.getElementById("chiiki").options[2].disabled = false;
				document.getElementById("shoshi").options[0].disabled = false;
				document.getElementById("shoshi").options[1].disabled = false;
				document.getElementById("shoshi").options[2].disabled = false;
				document.getElementById("trading").options[0].disabled = false;
				document.getElementById("trading").options[1].disabled = false;
				document.getElementById("trading").options[2].disabled = false;
				document.getElementById("kakiorosi_kibou_umu").options[0].disabled = false;
				document.getElementById("kakiorosi_kibou_umu").options[1].disabled = false;
				document.getElementById("kakiorosi_kibou_umu").options[2].disabled = false;
				document.getElementById("asobistore").options[0].disabled = false;
				document.getElementById("asobistore").options[1].disabled = false;
				document.getElementById("asobistore").options[2].disabled = false;
			</IMART>
			
			var template = $(".completeImageTemplate");
			template.find('[name="item_upFile_name"]').prop("disabled", true);
			template.find('[name="item_upFile_resname"]').prop("disabled", true);
			template.find('[name="comment"]').prop("disabled", true);

			// フォーム内にあるname属性と入力値を一括で取得する
			//var param = $('#inputFrom').serializeObject();
			//var inputList = $('#inputFrom').serializeArray();
			var inputList = $('#inputFrom').serializeRawValueArray();
			var param = {};
			for (var i = 0; i < inputList.length; i++) {
				var inputName = inputList[i].name;
				var inputVal = inputList[i].value;
				if (param[inputName] !== undefined) {
					if (!param[inputName].push) {
						param[inputName] = [param[inputName]];
					}
					param[inputName].push(inputVal || '');   
				} else {
					param[inputName] = inputVal || '';
				}
			}
			
			// 海外専用項目のクリアと非活性になった日本項目の取得
			if ($('#chiiki').val() == "1") {
				param.hanbaiyoteikosu_nihon = removeComma($('#hanbaiyoteikosu_nihon').val());
				param.hanbaiyoteikosu_chugoku = null;
				param.hanbaiyoteikosu_asia = null;
				param.hanbaiyoteikosu_chunanbei = null;
				param.hanbaiyoteikosu_europe = null;
				param.hanbaikoku_shosai = null;
			}
			
			// 非活性項目の登録
			if ($('#royalty_kingaku').is(':visible')) {
				param.royalty_kingaku = removeComma($('#royalty_kingaku').val());
			}
			
			template.find('[name="item_upFile_name"]').prop("disabled", false);
			template.find('[name="item_upFile_resname"]').prop("disabled", false);
			template.find('[name="comment"]').prop("disabled", false);

			<IMART type="condition" validity=$production_flg negative>
				param.ok_ng = '0';
			</IMART>
			
			// THATS_RIGHTS-1312 【UAT指摘】ダイアログ「更新しました」は余計
			// 枝番がなければ新規登録
			//var res;
			//if ($('#inputFrom').find('input[name=kikaku_edaban]').val()==""){
				// todo メッセージボックスは仮
			//    res = confirm('<imart type="message" id="KK03C001" escapeJs="true"></imart>');
			//}else{
			//    res = confirm('<imart type="message" id="KK03C002" escapeJs="true"></imart>');
			//}
		    //if( res == false ) {
		    //	return false;
		    //}

		    // 入力監視を解除
		    terminateFormChangeTrigger();
		    
			// 登録処理を行う
			jsspRpcPlanShohin.create(param);
			

        });
		
		//カレンダー横のアイコンを消す
		$('.imui-calendar').each(function(i,elem){
			 $(elem).next('img').hide();
		 });
		//カレンダー横アイコン押下
		$('.fa-calendar').parent().click(function(){
			$(this).parent().parent().find('img').click();
		});
		
//		$("#input").cleditor()[0].focus();
		
		$(window).on('load scroll', function() {
			fix_element();
		});
		$(window).on("load", function() {
			document.getElementById('body').style.display = 'block';
		});
		
		/*
		$(document).on("focus", ".text-number,.text-decimal" ,function() {
			var $this = $(this);
			$this.val(removeComma($this.val()));
		}).on("blur", ".text-number,.text-decimal" ,function() {
			var $this = $(this);
			$this.val(addComma($this.val()));
		});		
		
		$(".text-number,.text-decimal").each(function(index, elem) {
			var $elem = $(elem);
			$elem.val(addComma($elem.val()));
		});
		*/
		
		$('.require, .nat-only, .num-only').change(function(){
			if ($(this).attr('id') == 'shokai_seisanyotei_su') {				
				linkShokaiSeisanYoteisu();
			}
			mandatory_chk();
		});
		
		// RY金額計算
		$('#zeinuki_jodai, #mokuhyo_hambai_su, #shokai_seisanyotei_su, #ryouritu').change(function(){
			calc_royalty();
		});
		$(window).on("load", function() {
			calc_royalty();
		});
		
   	 	// カレンダーチェック
		$('.imui-calendar').change(function(e) {
    		mandatory_chk();
    	});
   	 	
   	 	function calc_royalty(){
	   	 	var zeinuki_jodai = $('#zeinuki_jodai').val() ? Number(convertWideToHalf($('#zeinuki_jodai').val()).replace(/,/g, '')) : 0;
			
			if(!isNaN(zeinuki_jodai)){
				var mokuhyo_hambai_su = $('#mokuhyo_hambai_su').val() ? Number(convertWideToHalf($('#mokuhyo_hambai_su').val()).replace(/,/g, '')) : 0;
				var shokai_seisanyotei_su = $('#shokai_seisanyotei_su').val() ? Number(convertWideToHalf($('#shokai_seisanyotei_su').val()).replace(/,/g, '')) : 0;
				var ryouritu = $('#ryouritu').val() ? Number(convertWideToHalf($('#ryouritu').val()).replace(/,/g, '')) * 0.01 : null;
				var ryAmt = "";
				// 初回生産数 = 0 ? 税抜上代　×　料率　×　目標販売数 (※税抜上代　×　料率：小数第3位切上) (計算結果：小数第1位切上)
	            // 初回生産数 > 0 ? 税抜上代　×　料率　×　初回生産数 (※税抜上代　×　料率：小数第3位切上) (計算結果：小数第1位切上)
				if ($('#shokai_seisanyotei_su').val() == "0") {
	                ryAmt = ryouritu ? Math.ceil(Math.floor(Math.ceil(Math.floor(zeinuki_jodai * ryouritu * 100000000) / 1000000) / 100 * mokuhyo_hambai_su * 100000000) / 100000000) : null;
				} else {
	                ryAmt = ryouritu ? Math.ceil(Math.floor(Math.ceil(Math.floor(zeinuki_jodai * ryouritu * 100000000) / 1000000) / 100 * shokai_seisanyotei_su * 100000000) / 100000000) : null;
				}
				$('#royalty_kingaku').val(addComma(convertWideToHalf(removeComma(ryAmt)))).addClass("formatted-value");
			}else{
				$('#royalty_kingaku').val("");
			}   	 		
   	 	}
		  
		function fix_element() {
			// 固定配置に使用する要素
			var $fixWrapper = $('.js-fix-wrapper');
			var $fix = $('.js-fix');
			var $fixArea = $('.js-fix-area');

			// 要素がある場合のみ処理
			if($fixWrapper.length && $fix.length && $fixArea.length) {
				var fixTop = $fixWrapper.offset().top;
				var fixEnd = $fixArea.offset().top + $fixArea.height();
				var fixHeight = $fix.height();
				var winScroll = $(window).scrollTop();
				var winheight = $(window).height();
				// 開始位置を通過する前
				if(winScroll < fixTop) {
					$fix.removeClass('is-fixed');
				// 終了位置を通過した後
				} else if(winScroll > fixEnd - fixHeight) {
					$fix.removeClass('is-fixed');
				// 対象範囲内の場合
				} else {
					$fix.addClass('is-fixed');
				}
			}
		}
    });
    
	// 必須項目チェック
    function mandatory_chk() {
		validateAndShowMessage();
    }
 	
 	function onSelectCalender() {
 		mandatory_chk();
 	}
 	
 	function linkShokaiSeisanYoteisu() {
 		if ($('[name=chiiki]').val() == '1') {
 			$('[name=hanbaiyoteikosu_nihon]').val($('[name=shokai_seisanyotei_su]').val());
 		}
 	}
 	
    document.getElementById("chiiki").onchange = chiiki_chk;
</script>
</body>
</html>
